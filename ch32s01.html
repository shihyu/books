<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>1. 引言</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch32.html" title="第 32 章 正則表達式" /><link rel="prev" href="ch32.html" title="第 32 章 正則表達式" /><link rel="next" href="ch32s02.html" title="2. 基本語法" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1. 引言</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch32.html">上一頁</a> </td><th width="60%" align="center">第 32 章 正則表達式</th><td width="20%" align="right"> <a accesskey="n" href="ch32s02.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2878891"></a>1. 引言</h2></div></div></div><p>以前我們用<code class="literal">grep</code>在一個檔案中找出包含某些字元串的行，比如在標頭檔中找出一個宏定義。其實<code class="literal">grep</code>還可以找出<span class="emphasis"><em>符合某個模式（Pattern）<a id="id2878281" class="indexterm"></a>的一類字元串</em></span>。例如找出所有符合<code class="literal">xxxxx@xxxx.xxx</code>模式的字元串（也就是email地址），要求x字元可以是字母、數字、下劃線、小數點或減號，email地址的每一部分可以有一個或多個x字元，例如<code class="literal">abc.d@ef.com</code>、<code class="literal">1_2@987-6.54</code>，當然符合這個模式的不全是合法的email地址，但至少可以做一次初步篩選，篩掉<code class="literal">a.b</code>、<code class="literal">c@d</code>等肯定不是email地址的字元串。再比如，找出所有符合<code class="literal">yyy.yyy.yyy.yyy</code>模式的字元串（也就是IP地址），要求y是0-9的數字，IP地址的每一部分可以有1-3個y字元。</p><p>如果要用<code class="literal">grep</code>查找一個模式，如何表示這個模式，這一類字元串，而不是一個特定的字元串呢？從這兩個簡單的例子可以看出，要表示一個模式至少應該包含以下信息：</p><div class="itemizedlist"><ul type="disc"><li><p>字元類（Character Class）<a id="id2878960" class="indexterm"></a>：如上例的x和y，它們在模式中表示一個字元，但是取值範圍是一類字元中的任意一個。</p></li><li><p>數量限定符（Quantifier）<a id="id2878974" class="indexterm"></a>： 郵件地址的每一部分可以有<span class="emphasis"><em>一個或多個</em></span>x字元，IP地址的每一部分可以有<span class="emphasis"><em>1-3個</em></span>y字元</p></li><li><p>各種字元類以及普通字元之間的位置關係：例如郵件地址分三部分，用普通字元<code class="literal">@</code>和<code class="literal">.</code>隔開，IP地址分四部分，用<code class="literal">.</code>隔開，每一部分都可以用字元類和數量限定符描述。為了表示位置關係，還有位置限定符（Anchor）<a id="id2879017" class="indexterm"></a>的概念，將在下面介紹。</p></li></ul></div><p>規定一些特殊語法表示字元類、數量限定符和位置關係，然後用這些特殊語法和普通字元一起表示一個模式，這就是正則表達式（Regular Expression）<a id="id2879032" class="indexterm"></a>。例如email地址的正則表達式可以寫成<code class="literal">[a-zA-Z0-9_.-]+@[a-zA-Z0-9_.-]+\.[a-zA-Z0-9_.-]+</code>，IP地址的正則表達式可以寫成<code class="literal">[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}</code>。下一節介紹正則表達式的語法，我們先看看正則表達式在<code class="literal">grep</code>中怎麼用。例如有這樣一個文本檔案<code class="literal">testfile</code>：</p><pre class="programlisting">192.168.1.1
1234.234.04.5678
123.4234.045.678
abcde</pre><p>查找其中包含IP地址的行：</p><pre class="screen">$ egrep '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' testfile
192.168.1.1
1234.234.04.5678</pre><p><code class="literal">egrep</code>相當於<code class="literal">grep -E</code>，表示採用Extended正則表達式語法。<code class="literal">grep</code>的正則表達式有Basic和Extended兩種規範，它們之間的區別下一節再解釋。另外還有<code class="literal">fgrep</code>命令，相當於<code class="literal">grep -F</code>，表示只搜索固定字元串而不搜索正則表達式模式，不會按正則表達式的語法解釋後面的參數。</p><p>注意正則表達式參數用單引號括起來了，因為正則表達式中用到的很多特殊字元在Shell中也有特殊含義（例如\），只有用單引號括起來才能保證這些字元原封不動地傳給<code class="literal">grep</code>命令，而不會被Shell解釋掉。</p><p><code class="literal">192.168.1.1</code>符合上述模式，由三個<code class="literal">.</code>隔開的四段組成，每段都是1到3個數字，所以這一行被找出來了，可為什麼<code class="literal">1234.234.04.5678</code>也被找出來了呢？因為<code class="literal">grep</code>找的是<span class="emphasis"><em>包含</em></span>某一模式的行，這一行包含一個符合模式的字元串<code class="literal">234.234.04.567</code>。相反，<code class="literal">123.4234.045.678</code>這一行不包含符合模式的字元串，所以不會被找出來。</p><p><code class="literal">grep</code>是一種查找過濾工具，正則表達式在<code class="literal">grep</code>中用來查找符合模式的字元串。其實正則表達式還有一個重要的應用是驗證用戶輸入是否合法，例如用戶通過網頁表單提交自己的email地址，就需要用程序驗證一下是不是合法的email地址，這個工作可以在網頁的Javascript中做，也可以在網站後台的程序中做，例如PHP、Perl、Python、Ruby、Java或C，所有這些語言都支持正則表達式，可以說，目前不支持正則表達式的編程語言實在很少見。除了編程語言之外，很多UNIX命令和工具也都支持正則表達式，例如grep、vi、sed、awk、emacs等等。“<span class="quote">正則表達式</span>”就像“<span class="quote">變數</span>”一樣，它是一個廣泛的概念，而不是某一種工具或編程語言的特性。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch32.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch32.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch32s02.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">第 32 章 正則表達式 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 2. 基本語法</td></tr></table></div></body></html>
