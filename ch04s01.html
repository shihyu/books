<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>1. if語句</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch04.html" title="第 4 章 分支語句" /><link rel="prev" href="ch04.html" title="第 4 章 分支語句" /><link rel="next" href="ch04s02.html" title="2. if/else語句" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1. if語句</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04.html">上一頁</a> </td><th width="60%" align="center">第 4 章 分支語句</th><td width="20%" align="right"> <a accesskey="n" href="ch04s02.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2718043"></a>1. if語句</h2></div></div></div><p>目前我們寫的簡單函數中可以有多條語句，但這些語句總是從前到後順序執行的。除了順序執行之外，有時候我們需要檢查一個條件，然後根據檢查的結果執行不同的後續代碼，在C語言中可以用分支語句（Selection Statement）<a id="id2717425" class="indexterm"></a>實現，比如：</p><pre class="programlisting">if (x != 0) {
	printf("x is nonzero.\n");
}</pre><p>其中<code class="literal">x != 0</code>表示“<span class="quote">x不等於0</span>”的條件，這個表達式稱為控製表達式（Controlling Expression）<a id="id2718058" class="indexterm"></a>如果條件成立，則{}中的語句被執行，否則{}中的語句不執行，直接跳到}後面。<code class="literal">if</code>和控製表達式改變了程序的控制流程（Control Flow）<a id="id2718073" class="indexterm"></a>，不再是從前到後順序執行，而是根據不同的條件執行不同的語句，這種控制流程稱為分支（Branch）<a id="id2718082" class="indexterm"></a>。上例中的!=號表示“<span class="quote">不等於</span>”，像這樣的運算符有：</p><div class="table"><a id="id2718094"></a><p class="title"><b>表 4.1. 關係運算符和相等性運算符</b></p><div class="table-contents"><table summary="關係運算符和相等性運算符" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>運算符</th><th>含義</th></tr></thead><tbody><tr><td>==</td><td>等於</td></tr><tr><td>!=</td><td>不等於</td></tr><tr><td>&gt;</td><td>大於</td></tr><tr><td>&lt;</td><td>小於</td></tr><tr><td>&gt;=</td><td>大於或等於</td></tr><tr><td>&lt;=</td><td>小於或等於</td></tr></tbody></table></div></div><br class="table-break" /><p>注意以下幾點：</p><div class="orderedlist"><ol type="1"><li><p>這裡的==表示數學中的相等關係，相當於數學中的=號，初學者常犯的錯誤是在控製表達式中把==寫成=，在C語言中=號是賦值運算符，兩者的含義完全不同。</p></li><li><p>如果表達式所表示的比較關係成立則值為真（True）<a id="id2718182" class="indexterm"></a>，否則為假（False）<a id="id2718189" class="indexterm"></a>，在C語言中分別用<code class="literal">int</code>型的1和0表示。如果變數<code class="literal">x</code>的值是-1，那麼<code class="literal">x&gt;0</code>這個表達式的值為0，<code class="literal">x&gt;-2</code>這個表達式的值為1。</p></li><li><p>在數學中<code class="literal">a&lt;b&lt;c</code>表示<code class="literal">b</code>既大於<code class="literal">a</code>又小於<code class="literal">c</code>，但作為C語言表達式卻不是這樣。以上幾種運算符都是左結合的，請讀者想一下這個表達式應如何求值。</p></li><li><p>這些運算符的兩個操作數應該是相同類型的，兩邊都是整型或者都是浮點型可以做比較，但兩個字元串不能做比較，在<a class="xref" href="ch25s01.html#stdlib.strcmp">第 1.5 節 “比較字元串”</a>我們會介紹比較字元串的方法。</p></li><li><p>==和!=稱為相等性運算符（Equality Operator）<a id="id2718276" class="indexterm"></a>，其餘四個稱為關係運算符（Relational Operator）<a id="id2718284" class="indexterm"></a>，相等性運算符的優先順序低於關係運算符。</p></li></ol></div><p>總結一下，<code class="literal">if (x != 0) { ... }</code>這個語句的計算順序是：首先求<code class="literal">x != 0</code>這個表達式的值，如果值為0，就跳過{}中的語句直接執行後面的語句，如果值為1，就先執行{}中的語句，然後再執行後面的語句。事實上控製表達式取任何非0值都表示真值，例如<code class="literal">if (x) { ... }</code>和<code class="literal">if (x != 0) { ... }</code>是等價的，如果<code class="literal">x</code>的值是2，則<code class="literal">x != 0</code>的值是1，但對於<code class="literal">if</code>來說不管是2還是1都表示真值。</p><p>和<code class="literal">if</code>語句相關的語法規則如下：</p><div class="literallayout"><p>語句 → if (控製表達式) 語句<br />
語句 → { 語句列表 }<br />
語句 → ;</p></div><p>在C語言中，任何允許出現語句的地方既可以是由;號結尾的一條語句，也可以是由{}括起來的若干條語句或聲明組成的語句塊（Statement Block）<a id="id2718370" class="indexterm"></a>，語句塊和上一章介紹的函數體的語法相同。注意語句塊的}後面不需要加;號。如果}後面加了;號，則這個;號本身又是一條新的語句了，在C語言中一個單獨的;號表示一條空語句（Null Statement）<a id="id2718364" class="indexterm"></a>。上例的語句塊中只有一條語句，其實沒必要寫成語句塊，可以簡單地寫成：</p><pre class="programlisting">if (x != 0)
	printf("x is nonzero.\n");</pre><p>語句塊中也可以定義局部變數，例如：</p><pre class="programlisting">void foo(void)
{
	int i = 0;
	{
		int i = 1;
		int j = 2;
		printf("i=%d, j=%d\n", i, j);
	}
	printf("i=%d\n", i); /* cannot access j here */
}</pre><p>和函數的局部變數同樣道理，每次進入語句塊時為變數<code class="literal">j</code>分配存儲空間，每次退出語句塊時釋放變數<code class="literal">j</code>的存儲空間。語句塊也構成一個作用域，和<a class="xref" href="ch03s04.html#func.scope">例 3.6 “作用域”</a>的分析類似，如果整個源檔案是一張大紙，<code class="literal">foo</code>函數是蓋在上面的一張小紙，則函數中的語句塊是蓋在小紙上面的一張更小的紙。語句塊中的變數<code class="literal">i</code>和函數的局部變數<code class="literal">i</code>是兩個不同的變數，因此兩次打印的<code class="literal">i</code>值是不同的；語句塊中的變數<code class="literal">j</code>在退出語句塊之後就沒有了，因此最後一行的<code class="literal">printf</code>不能打印變數<code class="literal">j</code>，否則編譯器會報錯。語句塊可以用在任何允許出現語句的地方，不一定非得用在<code class="literal">if</code>語句中，單獨使用語句塊通常是為了定義一些比函數的局部變數更“<span class="quote">局部</span>”的變數。</p><div class="simplesect" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a id="id2718484"></a>習題</h3></div></div></div><p>1、以下程序段編譯能通過，執行也不出錯，但是執行結果不正確（根據<a class="xref" href="ch01s03.html#intro.debug">第 3 節 “程序的調試”</a>的定義，這是一個語義錯誤），請分析一下哪裡錯了。還有，既然錯了為什麼編譯能通過呢？</p><pre class="programlisting">int x = -1;
if (x &gt; 0);
	printf("x is positive.\n");</pre></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s02.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">第 4 章 分支語句 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 2. if/else語句</td></tr></table></div></body></html>
