<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5. 常用的make命令行選項</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch22.html" title="第 22 章 Makefile基礎" /><link rel="prev" href="ch22s04.html" title="4. 自動處理標頭檔的依賴關係" /><link rel="next" href="ch23.html" title="第 23 章 指針" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. 常用的<code class="literal">make</code>命令行選項</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch22s04.html">上一頁</a> </td><th width="60%" align="center">第 22 章 Makefile基礎</th><td width="20%" align="right"> <a accesskey="n" href="ch23.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2806383"></a>5. 常用的<code class="literal">make</code>命令行選項</h2></div></div></div><p><code class="literal">-n</code>選項只打印要執行的命令，而不會真的執行命令，這個選項有助於我們檢查Makefile寫得是否正確，由於Makefile不是順序執行的，用這個選項可以先看看命令的執行順序，確認無誤了再真正執行命令。</p><p><code class="literal">-C</code>選項可以切換到另一個目錄執行那個目錄下的Makefile，比如先退到上一級目錄再執行我們的Makefile（假設我們的原始碼都放在<code class="literal">testmake</code>目錄下）：</p><pre class="screen">$ cd ..
$ make -C testmake
make: Entering directory `/home/akaedu/testmake'
cc    -c -o main.o main.c
cc    -c -o stack.o stack.c
cc    -c -o maze.o maze.c
gcc main.o stack.o maze.o -o main
make: Leaving directory `/home/akaedu/testmake'</pre><p>一些規模較大的項目會把不同的模組或子系統的原始碼放在不同的子目錄中，然後在每個子目錄下都寫一個該目錄的Makefile，然後在一個總的Makefile中用<code class="literal">make -C</code>命令執行每個子目錄下的Makefile。例如Linux內核原始碼根目錄下有<code class="literal">Makefile</code>，子目錄<code class="literal">fs</code>、<code class="literal">net</code>等也有各自的<code class="literal">Makefile</code>，二級子目錄<code class="literal">fs/ramfs</code>、<code class="literal">net/ipv4</code>等也有各自的<code class="literal">Makefile</code>。</p><p>在<code class="literal">make</code>命令行也可以用<code class="literal">=</code>或<code class="literal">:=</code>定義變數，如果這次編譯我想加調試選項<code class="literal">-g</code>，但我不想每次編譯都加<code class="literal">-g</code>選項，可以在命令行定義<code class="literal">CFLAGS</code>變數，而不必修改Makefile編譯完了再改回來：</p><pre class="screen">$ make CFLAGS=-g
cc -g   -c -o main.o main.c
cc -g   -c -o stack.o stack.c
cc -g   -c -o maze.o maze.c
gcc main.o stack.o maze.o -o main</pre><p>如果在Makefile中也定義了<code class="literal">CFLAGS</code>變數，則命令行的值覆蓋Makefile中的值。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch22s04.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch22.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch23.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">4. 自動處理標頭檔的依賴關係 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 第 23 章 指針</td></tr></table></div></body></html>
