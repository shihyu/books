<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7. 指向數組的指針與多維數組</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch23.html" title="第 23 章 指針" /><link rel="prev" href="ch23s06.html" title="6. 指向指針的指針與指針數組" /><link rel="next" href="ch23s08.html" title="8. 函數類型和函數指針類型" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7. 指向數組的指針與多維數組</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch23s06.html">上一頁</a> </td><th width="60%" align="center">第 23 章 指針</th><td width="20%" align="right"> <a accesskey="n" href="ch23s08.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2813032"></a>7. 指向數組的指針與多維數組</h2></div></div></div><p>指針可以指向復合類型，上一節講了指向指針的指針，這一節學習指向數組的指針。以下定義一個指向數組的指針，該數組有10個<code class="literal">int</code>元素：</p><pre class="programlisting">int (*a)[10];</pre><p>和上一節指針數組的定義<code class="literal">int *a[10];</code>相比，僅僅多了一個<code class="literal">()</code>括號。如何記住和區分這兩種定義呢？我們可以認為<code class="literal">[]</code>比<code class="literal">*</code>有更高的優先順序，如果<code class="literal">a</code>先和<code class="literal">*</code>結合則表示<code class="literal">a</code>是一個指針，如果<code class="literal">a</code>先和<code class="literal">[]</code>結合則表示<code class="literal">a</code>是一個數組。<code class="literal">int *a[10];</code>這個定義可以拆成兩句：</p><pre class="programlisting">typedef int *t;
t a[10];</pre><p><code class="literal">t</code>代表<code class="literal">int *</code>類型，<code class="literal">a</code>則是由這種類型的元素組成的數組。<code class="literal">int (*a)[10];</code>這個定義也可以拆成兩句：</p><pre class="programlisting">typedef int t[10];
t *a;</pre><p><code class="literal">t</code>代表由10個<code class="literal">int</code>組成的數組類型，<code class="literal">a</code>則是指向這種類型的指針。</p><p>現在看指向數組的指針如何使用：</p><pre class="programlisting">int a[10];
int (*pa)[10] = &amp;a;</pre><p><code class="literal">a</code>是一個數組，在<code class="literal">&amp;a</code>這個表達式中，數組名做左值，取整個數組的首地址賦給指針<code class="literal">pa</code>。注意，<code class="literal">&amp;a[0]</code>表示數組<code class="literal">a</code>的首元素的首地址，而<code class="literal">&amp;a</code>表示數組<code class="literal">a</code>的首地址，顯然這兩個地址的數值相同，但這兩個表達式的類型是兩種不同的指針類型，前者的類型是<code class="literal">int *</code>，而後者的類型是<code class="literal">int (*)[10]</code>。<code class="literal">*pa</code>就表示<code class="literal">pa</code>所指向的數組<code class="literal">a</code>，所以取數組的<code class="literal">a[0]</code>元素可以用表達式<code class="literal">(*pa)[0]</code>。注意到<code class="literal">*pa</code>可以寫成<code class="literal">pa[0]</code>，所以<code class="literal">(*pa)[0]</code>這個表達式也可以改寫成<code class="literal">pa[0][0]</code>，<code class="literal">pa</code>就像一個二維數組的名字，它表示什麼含義呢？下面把<code class="literal">pa</code>和二維數組放在一起做個分析。</p><p><code class="literal">int a[5][10];</code>和<code class="literal">int (*pa)[10];</code>之間的關係同樣類似於<code class="literal">int a[10];</code>和<code class="literal">int *pa;</code>之間的關係：<code class="literal">a</code>是由一種元素組成的數組，<code class="literal">pa</code>則是指向這種元素的指針。所以，如果<code class="literal">pa</code>指向<code class="literal">a</code>的首元素：</p><pre class="programlisting">int a[5][10];
int (*pa)[10] = &amp;a[0];</pre><p>則<code class="literal">pa[0]</code>和<code class="literal">a[0]</code>取的是同一個元素，唯一比原來複雜的地方在於這個元素是由10個<code class="literal">int</code>組成的數組，而不是基本類型。這樣，我們可以把<code class="literal">pa</code>當成二維數組名來使用，<code class="literal">pa[1][2]</code>和<code class="literal">a[1][2]</code>取的也是同一個元素，而且<code class="literal">pa</code>比<code class="literal">a</code>用起來更靈活，數組名不支持賦值、自增等運算，而指針可以支持，<code class="literal">pa++</code>使<code class="literal">pa</code>跳過二維數組的一行（40個位元組），指向<code class="literal">a[1]</code>的首地址。</p><div class="simplesect" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a id="id2813445"></a>習題</h3></div></div></div><p>1、定義以下變數：</p><pre class="programlisting">char a[4][3][2] = {{{'a', 'b'}, {'c', 'd'}, {'e', 'f'}},
		   {{'g', 'h'}, {'i', 'j'}, {'k', 'l'}},
		   {{'m', 'n'}, {'o', 'p'}, {'q', 'r'}},
		   {{'s', 't'}, {'u', 'v'}, {'w', 'x'}}};

char (*pa)[2] = &amp;a[1][0];
char (*ppa)[3][2] = &amp;a[1];</pre><p>要想通過<code class="literal">pa</code>或<code class="literal">ppa</code>訪問數組<code class="literal">a</code>中的<code class="literal">'r'</code>元素，分別應該怎麼寫？</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch23s06.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch23.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch23s08.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">6. 指向指針的指針與指針數組 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 8. 函數類型和函數指針類型</td></tr></table></div></body></html>
