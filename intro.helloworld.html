<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>4. 第一個程序</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch01.html" title="第 1 章 程序的基本概念" /><link rel="prev" href="ch01s03.html" title="3. 程序的調試" /><link rel="next" href="ch02.html" title="第 2 章 常量、變數和表達式" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. 第一個程序</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s03.html">上一頁</a> </td><th width="60%" align="center">第 1 章 程序的基本概念</th><td width="20%" align="right"> <a accesskey="n" href="ch02.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="intro.helloworld"></a>4. 第一個程序</h2></div></div></div><p>通常一本教編程的書中第一個例子都是打印“<span class="quote">Hello, World.</span>”，這個傳統源自<a class="xref" href="bi01.html#bibli.kr" title="The C Programming Language">[<abbr class="abbrev">K&amp;R</abbr>]</a>，用C語言寫這個程序可以這樣寫：</p><div class="example"><a id="id2705156"></a><p class="title"><b>例 1.1. Hello World</b></p><div class="example-contents"><pre class="programlisting">#include &lt;stdio.h&gt;

/* main: generate some simple output */

int main(void)
{
	printf("Hello, world.\n");
	return 0;
}</pre></div></div><br class="example-break" /><p>將這個程序保存成<code class="literal">main.c</code>，然後編譯執行：</p><pre class="screen">$ gcc main.c
$ ./a.out
Hello, world.</pre><p><code class="literal">gcc</code>是Linux平台的C編譯器，編譯後在當前目錄下生成執行檔<code class="literal">a.out</code>，直接在命令行輸入這個執行檔的路徑就可以執行它。如果不想把檔案名叫<code class="literal">a.out</code>，可以用<code class="literal">gcc</code>的<code class="literal">-o</code>參數自己指定檔案名：</p><pre class="screen">$ gcc main.c -o main
$ ./main
Hello, world.</pre><p>雖然這只是一個很小的程序，但我們目前暫時還不具備相關的知識來完全理解這個程序，比如程序的第一行，還有程序主體的<code class="literal">int main(void){...return 0;}</code>結構，這些部分我們暫時不詳細解釋，讀者現在只需要把它們看成是每個程序按慣例必須要寫的部分（Boilerplate）<a id="id2705235" class="indexterm"></a>。但要注意<code class="literal">main</code>是一個特殊的名字，C程序總是從<code class="literal">main</code>裡面的第一條語句開始執行的，在這個程序中是指<code class="literal">printf</code>這條語句。</p><p>第3行的<code class="literal">/* ... */</code>結構是一個註釋（Comment）<a id="id2705268" class="indexterm"></a>，其中可以寫一些描述性的話，解釋這段程序在做什麼。註釋只是寫給程序員看的，編譯器會忽略從<code class="literal">/*</code>到<code class="literal">*/</code>的所有字元，所以寫註釋沒有語法規則，愛怎麼寫就怎麼寫，並且不管寫多少都不會被編譯進執行檔中。</p><p><code class="literal">printf</code>語句的作用是把消息打印到屏幕。注意語句的末尾以;號（Semicolon）<a id="id2705299" class="indexterm"></a>結束，下一條語句<code class="literal">return 0;</code>也是如此。</p><p>C語言用{}括號（Brace或Curly Brace）<a id="id2705316" class="indexterm"></a>把語法結構分成組，在上面的程序中<code class="literal">printf</code>和<code class="literal">return</code>語句套在<code class="literal">main</code>的{}括號中，表示它們屬於<code class="literal">main</code>的定義之中。我們看到這兩句相比<code class="literal">main</code>那一行都縮進（Indent）<a id="id2705353" class="indexterm"></a>了一些，在代碼中可以用若干個空格（Blank）<a id="id2705360" class="indexterm"></a>和Tab字元來縮進，縮進不是必須的，但這樣使我們更容易看出這兩行是屬於<code class="literal">main</code>的定義之中的，要寫出漂亮的程序必須有整齊的縮進，<a class="xref" href="ch09s01.html#codingstyle.indent">第 1 節 “縮進和空白”</a>將介紹推薦的縮進寫法。</p><p>正如前面所說，編譯器對於語法錯誤是毫不留情的，如果你的程序有一點拼寫錯誤，例如第一行寫成了<code class="literal">stdoi.h</code>，在編譯時會得到錯誤提示：</p><pre class="screen">$ gcc main.c
main.c:1:19: error: stdoi.h: No such file or directory
...</pre><p>這個錯誤提示非常緊湊，初學者往往不容易看明白出了什麼錯誤，即使知道這個錯誤提示說的是第1行有錯誤，很多初學者對照着書看好幾遍也看不出自己這一行哪裡有錯誤，因為他們對符號和拼寫不敏感（尤其是英文較差的初學者），他們還不知道這些符號是什麼意思又如何能記住正確的拼寫？對於初學者來說，最想看到的錯誤提示其實是這樣的：“<span class="quote">在<code class="literal">main.c</code>程序第1行的第19列，您試圖包含一個叫做<code class="literal">stdoi.h</code>的檔案，可惜我沒有找到這個檔案，但我卻找到了一個叫做<code class="literal">stdio.h</code>的檔案，我猜這個才是您想要的，對嗎？</span>”可惜沒有任何編譯器會友善到這個程度，大多數時候你所得到的錯誤提示並不能直接指出誰是犯人，而只是一個線索，你需要根據這個線索做一些偵探和推理。</p><p>有些時候編譯器的提示信息不是<code class="literal">error</code>而是<code class="literal">warning</code>，例如把上例中的<code class="literal">printf("Hello, world.\n");</code>改成<code class="literal">printf(1);</code>然後編譯運行：</p><pre class="screen">$ gcc main.c
main.c: In function ‘main’:
main.c:7: warning: passing argument 1 of ‘printf’ makes pointer from integer without a cast
$ ./a.out 
Segmentation fault</pre><p>這個警告信息是說類型不匹配，但勉強還能配得上。警告信息不是致命錯誤，編譯仍然可以繼續，如果整個編譯過程只有警告信息而沒有錯誤信息，仍然可以生成執行檔。但是，警告信息也是不容忽視的。出警告信息說明你的程序寫得不夠規範，可能有Bug，雖然能編譯生成執行檔，但程序的運行結果往往是不正確的，例如上面的程序運行時出了一個段錯誤，這屬於運行時錯誤。各種警告信息的嚴重程度不同，像上面這種警告几乎一定表明程序中有Bug，而另外一些警告只表明程序寫得不夠規範，一般還是能正確運行的，有些不重要的警告信息<code class="literal">gcc</code>預設是不提示的，但這些警告信息也有可能表明程序中有Bug。<span class="emphasis"><em>一個好的習慣是打開<code class="literal">gcc</code>的<code class="literal">-Wall</code>選項，也就是讓<code class="literal">gcc</code>提示所有的警告信息，不管是嚴重的還是不嚴重的，然後把這些問題從代碼中全部消滅</em></span>。比如把上例中的<code class="literal">printf("Hello, world.\n");</code>改成<code class="literal">printf(0);</code>然後編譯運行：</p><pre class="screen">$ gcc main.c
$ ./a.out</pre><p>編譯既不報錯也不報警告，一切正常，但是運行程序什麼也不打印。如果打開<code class="literal">-Wall</code>選項編譯就會報警告了：</p><pre class="screen">$ gcc -Wall main.c
main.c: In function ‘main’:
main.c:7: warning: null argument where non-null required (argument 1)</pre><p>如果<code class="literal">printf</code>中的0是你不小心寫上去的（例如錯誤地使用了編輯器的查找替換功能），這個警告就能幫助你發現錯誤。雖然本書的命令行為了突出重點通常省略<code class="literal">-Wall</code>選項，但是強烈建議你寫每一個編譯命令時都加上<code class="literal">-Wall</code>選項。</p><div class="simplesect" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a id="id2705581"></a>習題</h3></div></div></div><p>1、儘管編譯器的錯誤提示不夠友好，但仍然是學習過程中一個很有用的工具。你可以像上面那樣，從一個正確的程序開始每次改動一小點，然後編譯看是什麼結果，如果出錯了，就儘量記住編譯器給出的錯誤提示並把改動還原。因為錯誤是你改出來的，你已經知道錯誤原因是什麼了，所以能很容易地把錯誤原因和錯誤提示信息對應起來記住，這樣下次你在毫無防備的情況下撞到這個錯誤提示時就會很容易想到錯誤原因是什麼了。這樣反覆練習，有了一定的經驗積累之後面對編譯器的錯誤提示就會從容得多了。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s03.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch01.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch02.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">3. 程序的調試 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 第 2 章 常量、變數和表達式</td></tr></table></div></body></html>
