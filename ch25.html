<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 25 章 C標準庫</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="pt02.html" title="部分 II. C語言本質" /><link rel="prev" href="ch24s06.html" title="6. 可變參數" /><link rel="next" href="ch25s01.html" title="1. 字元串操作函數" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 25 章 C標準庫</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch24s06.html">上一頁</a> </td><th width="60%" align="center">部分 II. C語言本質</th><td width="20%" align="right"> <a accesskey="n" href="ch25s01.html">下一頁</a></td></tr></table><hr /></div><div class="chapter" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a id="id2827083"></a>第 25 章 C標準庫</h2></div></div></div><div class="toc"><p><b>目錄</b></p><dl><dt><span class="sect1"><a href="ch25s01.html">1. 字元串操作函數</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch25s01.html#id2827594">1.1. 初始化字元串</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2827671">1.2. 取字元串的長度</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2827741">1.3. 拷貝字元串</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2828376">1.4. 連接字元串</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2828656">1.5. 比較字元串</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2828881">1.6. 搜索字元串</a></span></dt><dt><span class="sect2"><a href="ch25s01.html#id2829046">1.7. 分割字元串</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch25s02.html">2. 標準I/O庫函數</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch25s02.html#id2829671">2.1. 檔案的基本概念</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2829869">2.2. fopen/fclose</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2830485">2.3. stdin/stdout/stderr</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2830807">2.4. errno與perror函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2831236">2.5. 以位元組為單位的I/O函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2831814">2.6. 操作讀寫位置的函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2832034">2.7. 以字元串為單位的I/O函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2832480">2.8. 以記錄為單位的I/O函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2832755">2.9. 格式化I/O函數</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2834346">2.10. C標準庫的I/O緩衝區</a></span></dt><dt><span class="sect2"><a href="ch25s02.html#id2834904">2.11. 本節綜合練習</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch25s03.html">3. 數值字元串轉換函數</a></span></dt><dt><span class="sect1"><a href="ch25s04.html">4. 分配內存的函數</a></span></dt></dl></div><p>在前面的各章中我們已經見過C標準庫的一些用法，總結如下：</p><div class="itemizedlist"><ul type="disc"><li><p>我們最常用的是包含<code class="literal">stdio.h</code>，使用其中聲明的<code class="literal">printf</code>函數，這個函數在<code class="literal">libc</code>中實現，程序在運行時要動態連結<code class="literal">libc</code>共享庫。</p></li><li><p>在<a class="xref" href="ch03s01.html#func.mathfunc">第 1 節 “數學函數”</a>中用到了<code class="literal">math.h</code>中聲明的<code class="literal">sin</code>和<code class="literal">log</code>函數，使用這些函數需要動態連結<code class="literal">libm</code>共享庫。</p></li><li><p>在<a class="xref" href="ch08s02.html#array.statistic">第 2 節 “數組應用實例：統計隨機數”</a>中用到了<code class="literal">stdlib.h</code>中聲明的<code class="literal">rand</code>函數，還提到了這個標頭檔中定義的<code class="literal">RAND_MAX</code>常量，在<a class="xref" href="ch08s05.html#array.scissor">例 8.5 “剪刀石頭布”</a>中用到了<code class="literal">stdlib.h</code>中聲明的<code class="literal">srand</code>函數和<code class="literal">time.h</code>中聲明的<code class="literal">time</code>函數。使用這些函數需要動態連結<code class="literal">libc</code>共享庫。</p></li><li><p>在<a class="xref" href="ch19s02.html#asmc.main">第 2 節 “<code class="literal">main</code>函數和啟動常式”</a>中用到了<code class="literal">stdlib.h</code>中聲明的<code class="literal">exit</code>函數，使用這個函數需要動態連結<code class="literal">libc</code>共享庫。</p></li><li><p>在<a class="xref" href="ch11s06.html#sortsearch.binary">第 6 節 “折半查找”</a>中用到了<code class="literal">assert.h</code>中定義的<code class="literal">assert</code>宏，在<a class="xref" href="ch21s04.html#prep.other">第 4 節 “其它預處理特性”</a>中我們看到了這個宏的一種實現，它的實現需要調用<code class="literal">stdio.h</code>和<code class="literal">stdlib.h</code>中聲明的函數，所以使用這個宏也需要動態連結<code class="literal">libc</code>共享庫。</p></li><li><p>在<a class="xref" href="ch16s02.html#op.sizeoftypedef">第 2.4 節 “sizeof運算符與typedef類型聲明”</a>中提到了<code class="literal">size_t</code>類型在<code class="literal">stddef.h</code>中定義，在<a class="xref" href="ch23s01.html#pointer.intro">第 1 節 “指針的基本概念”</a>中提到了<code class="literal">NULL</code>指針也在<code class="literal">stddef.h</code>中定義。</p></li><li><p>在<a class="xref" href="ch24s01.html#interface.prereq">第 1 節 “本章的預備知識”</a>中介紹了<code class="literal">stdlib.h</code>中聲明的<code class="literal">malloc</code>和<code class="literal">free</code>函數以及<code class="literal">string.h</code>中聲明的<code class="literal">strcpy</code>和<code class="literal">strncpy</code>函數，使用這些函數需要動態連結<code class="literal">libc</code>共享庫。</p></li><li><p>在<a class="xref" href="ch24s06.html#interface.va">第 6 節 “可變參數”</a>中介紹了<code class="literal">stdarg.h</code>中定義的<code class="literal">va_list</code>類型和<code class="literal">va_arg</code>、<code class="literal">va_start</code>、<code class="literal">va_end</code>等宏定義，並給出了一種實現，這些宏定義的實現並沒有調用庫函數，所以不依賴于某個共享庫，這一點和<code class="literal">assert</code>不同。</p></li></ul></div><p>總結一下，Linux平台提供的C標準庫包括：</p><div class="itemizedlist"><ul type="disc"><li><p>一組標頭檔，定義了很多類型和宏，聲明了很多庫函數。這些標頭檔放在哪些目錄下取決於不同的編譯器，在我的系統上，<code class="literal">stdarg.h</code>和<code class="literal">stddef.h</code>位於<code class="literal">/usr/lib/gcc/i486-linux-gnu/4.3.2/include</code>目錄下，<code class="literal">stdio.h</code>、<code class="literal">stdlib.h</code>、<code class="literal">time.h</code>、<code class="literal">math.h</code>、<code class="literal">assert.h</code>位於<code class="literal">/usr/include</code>目錄下。C99標準定義的標頭檔有24個，本書只介紹其中最基本、最常用的幾個。</p></li><li><p>一組庫檔案，提供了庫函數的實現。大多數庫函數在<code class="literal">libc</code>共享庫中，有些庫函數在另外的共享庫中，例如數學函數在<code class="literal">libm</code>中。在<a class="xref" href="ch20s04.html#link.shared">第 4 節 “共享庫”</a>講過，通常<code class="literal">libc</code>共享庫是<code class="literal">/lib/libc.so.6</code>，而我的系統啟用了hwcap機制，<code class="literal">libc</code>共享庫是<code class="literal">/lib/tls/i686/cmov/libc.so.6</code>。</p></li></ul></div><p>本章介紹另外一些最基本和最常用的庫函數（包括一些不屬於C標準但在UNIX平台上很常用的函數），寫這一章是為了介紹字元串操作和檔案操作的基本概念，而不是為了寫一本C標準庫函數的參考手冊，Man Page已經是一本很好的手冊了，讀者學完這一章之後在開發時應該查閲Man Page，而不是把我這一章當參考手冊來翻，所以本章不會面面俱到介紹所有的庫函數，對於本章講到的函數有些也不會講得很細，因為我假定讀者經過上一章的學習再結合我講過的基本概念已經能看懂相關的Man Page了。很多技術書的作者給自己的書太多定位，既想寫成一本入門教程，又想寫成一本參考手冊，我覺得這樣不好，讀者過于依賴技術書就失去了看真正的手冊的能力。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch24s06.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="pt02.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch25s01.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">6. 可變參數 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 1. 字元串操作函數</td></tr></table></div></body></html>
