<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>4. 函數</title><link rel="stylesheet" href="styles.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.html" title="Linux C編程一站式學習" /><link rel="up" href="ch09.html" title="第 9 章 編碼風格" /><link rel="prev" href="ch09s03.html" title="3. 標識符命名" /><link rel="next" href="ch09s05.html" title="5. indent工具" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. 函數</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch09s03.html">上一頁</a> </td><th width="60%" align="center">第 9 章 編碼風格</th><td width="20%" align="right"> <a accesskey="n" href="ch09s05.html">下一頁</a></td></tr></table><hr /></div><div class="sect1" lang="zh-cn" xml:lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2738767"></a>4. 函數</h2></div></div></div><p>每個函數都應該設計得儘可能簡單，簡單的函數才容易維護。應遵循以下原則：</p><div class="orderedlist"><ol type="1"><li><p>實現一個函數只是為了做好一件事情，不要把函數設計成用途廣泛、面面俱到的，這樣的函數肯定會超長，而且往往不可重用，維護困難。</p></li><li><p>函數內部的縮進層次不宜過多，一般以少於4層為宜。如果縮進層次太多就說明設計得太複雜了，應考慮分割成更小的函數（Helper Function）<a id="id2738797" class="indexterm"></a>來調用。</p></li><li><p>函數不要寫得太長，建議在24行的標準終端上不超過兩屏，太長會造成閲讀困難，如果一個函數超過兩屏就應該考慮分割函數了。<a class="xref" href="bi01.html#bibli.codingstyle" title="Linux內核原始碼目錄下的Documentation/CodingStyle檔案">[<abbr class="abbrev">CodingStyle</abbr>]</a>中特別說明，如果一個函數在概念上是簡單的，只是長度很長，這倒沒關係。例如函數由一個大的<code class="literal">switch</code>組成，其中有非常多的<code class="literal">case</code>，這是可以的，因為各<code class="literal">case</code>分支互不影響，整個函數的複雜度只等於其中一個<code class="literal">case</code>的複雜度，這種情況很常見，例如TCP協議的狀態機實現。</p></li><li><p>執行函數就是執行一個動作，函數名通常應包含動詞，例如<code class="literal">get_current</code>、<code class="literal">radix_tree_insert</code>。</p></li><li><p>比較重要的函數定義上側必須加註釋，說明此函數的功能、參數、返回值、錯誤碼等。</p></li><li><p>另一種度量函數複雜度的辦法是看有多少個局部變數，5到10個局部變數已經很多了，再多就很難維護了，應該考慮分割成多個函數。</p></li></ol></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch09s03.html">上一頁</a> </td><td width="20%" align="center"><a accesskey="u" href="ch09.html">上一級</a></td><td width="40%" align="right"> <a accesskey="n" href="ch09s05.html">下一頁</a></td></tr><tr><td width="40%" align="left" valign="top">3. 標識符命名 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始頁</a></td><td width="40%" align="right" valign="top"> 5. indent工具</td></tr></table></div></body></html>
